<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>第二步</title>
    <link rel="stylesheet" href="../../static/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../static/res/static/css/purchasing.css">
    <style>
        .forn {
            width: 350px;
            margin: 0 auto;
        }

        ul {
            position: absolute;
            top: 95px;
            left: 17px;
        }

        .atitle > span {
            margin: 0 auto;
        }

        .btn {
            width: 105px;
            height: 39px;
            background: rgba(55, 38, 89, 1);
            border-radius: 4px;
            font-size: 14px;
            text-align: center;
            line-height: 39px;
            border: 0;
            color: #fff;
            cursor: pointer;
            position: absolute;
            left: 44%;
            bottom: 32px;
        }
    </style>
</head>
<body>
<div class="Popout">
    <div class="atitle">
        <span>采购申请</span>
    </div>
    <ul>
        <li class="ULI"><a lay-href="javascript:;" class="ULIP"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
    </ul>

    <div style="height: 417px;overflow: auto;padding-top:25px">
        <form class="layui-form forn" action="" lay-filter="component-form-group">
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">单据编号：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="CG00008" disabled
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">采购类型：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="直接采购"
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;"><span
                        class="xing">*</span>采购用途：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="modules" lay-verify="required" lay-search="" style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="1">原材料</option>
                        <option value="2">固定资产</option>
                        <option value="3">无形资产</option>
                        <option value="4">办公用品</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>货物名称：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" name="uname" lay-verify="required|uname" autocomplete="off" class="layui-input"
                           placeholder="请输入名称"
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>建议单价：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" placeholder="请输入建议单价"
                           style="min-height: 30px;line-height: 30px; height: 30px;" name="price"
                           onkeyup="checkInt(this)" id=txtPrice
                           lay-verify="required|number|price">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>单位：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" placeholder="请输入单位  例:台,个"
                           style="min-height: 30px;line-height: 30px; height: 30px;" lay-verify="required">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>数量：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" name="quantity" lay-verify="required|number|quantity" autocomplete="off"
                           class="layui-input" placeholder="请输入数量" onkeyup="checkInt(this)" id=txtAmount
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">建议金额：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" placeholder="请输入您的建议金额" disabled
                           style="min-height: 30px;line-height: 30px; height: 30px;" id=txtTotal>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>申请人：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="modules" lay-verify="required" lay-search="" style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="1">纪晶</option>
                        <option value="2">刘静</option>
                        <option value="3">李荣</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">申请部门：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="封边打孔车间（二车间）" disabled
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">申请日期：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="2020/12/6  8:40:10" disabled
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">部门负责人：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="徐蓉" disabled
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">公司负责人：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="孙鸿" disabled
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            {#            <a class="btn" href="purchaes_requisitions_determine" class="layui-btn">提交</a>#}
            <button class="layui-btn btn" lay-submit="" lay-filter="demo2">提交</button>
        </form>
        <div style="clear: both"></div>
    </div>
</div>
<script src="../../static/layuiadmin/layui/layui.js"></script>
<script>
    layui.use(['form', 'layedit', 'laydate','jquery'], function () {

            var form = layui.form
                , layer = layui.layer
                , layedit = layui.layedit
                , $ = layui.jquery
                , laydate = layui.laydate;

            //日期
            laydate.render({
                elem: '#date'
            });
            laydate.render({
                elem: '#date1'
            });

            //自定义验证规则
            form.verify({
                uname: function (value) {
                    if (!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)) {
                        return '用户名不能有特殊字符';
                    }
                },
                price: function (value) {
                    if (!new RegExp("^((\\d+(\.\\d?[1-9])?)|(\\d*[1-9]\\d*\\.\\d{0,2}))$").test(value)) {
                        return '价格大于0,且最多有两位小数'
                    }
                },
                quantity: function (value) {
                    if (value <= 0) {
                        return "数量必须大于0"
                    }
                }
            });
        form.on('submit(demo2)', function (data) {
            //通用表单提交(AJAX方式)
            console.log(data)
            $.ajax({
                url: "/purchaes_requisitions_create_data",
                type: "post",
                data: $(data.form).serialize(),

                success: function () {
                    location.href = "/purchaes_requisitions_determine";

                }
            });
        });
    });

    function checkInt(o) {
        theV = isNaN(parseInt(o.value)) ? 0 : parseInt(o.value);
        if (theV != o.value) {
            o.value = theV;
        }
        txtTotal.value = txtAmount.value * txtPrice.value;
    }

    function checkP(o) {
        theV = isNaN(parseFloat(o.value)) ? 0 : parseFloat(o.value);
        theV = parseInt(theV * 100) / 100;
        if (theV != o.value) {
            theV = (theV * 100).toString();
            theV = theV.substring(0, theV.length - 2) + "." + theV.substring(theV.length - 2, theV.length)
            o.value = theV;
        }
        txtTotal.value = txtAmount.value * txtPrice.value;
    }
</script>
</body>
</html>